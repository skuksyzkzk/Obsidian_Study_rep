
# 설치 
> npm -g install truffle 
> truffle version

### ganache-cli 설치
> npm -g install ganache-cli
> ganache-cli // 이거 실행시 노드들 연결되는거 

--- 

### 초기 세팅 

작업하는 해당 폴더로 들어가서 vscode 터미널 cmd 킨 다음 
> truffle init 

하면 contract,migration,test 폴더 생김 
migration폴더가 이제 배포하는 폴더 
test 폴더에는 test관리

### test 

1. 솔리디티 자체 언어로 테스트하기 
2. js를 사용해서 하는 테스트 

## 배포 
```

const Lottery = artifacts.require("Lottery"); // build파일의 json을 가져오는 것

  

module.exports =function(deployer) {

    deployer.deploy(Lottery);

}
```

Deployer는 truffle의 config파일에서 설정한 주소로 하여 그 주소를 가져와서 배포시 사용되는 것 

> truffle migrate 해서 처음에 배포하고 
> //그뒤로 배포할때는 
> truffle migrate --reset 으로 배포해줘야된다 .

배포하기전에 ganache-cli -d -m tutorial로 먼저 노드들 연결하고 사용해야된다.


배포후 
> truffle console을 입력하면 여기서이제  web3관련해서 지금 계정의 잔고나 이런거를 알수있다.

eth = web3.eth   // 이거를 실행후 
eth.getBalance();등 여러가지 사용가능 

> Lottery.addrress 하면 json파일에 있는 주소가 나오게 되고 
> Lottery.deployed().then(function(instance){lt=instance}) 
> lt. //이렇게 친후 tab키를 두번 누르면 사용가능한 함수가 나오게 된다.

> lt.address하면 컨트랙트 주소가 나오고 
> lt.owner() 하면 첫번째 노드의 주소가 나오게 된다 0번째를 deployer로 사용한 모습 또한 
> 위의 코드에서 address public 여기 public으로 선언했기 때문에 자동으로 getter가 생긴 것 



## 테스트 

테스트할때는 모카하고 차이에서 하는것과 같다고 한다 

### BeforeEach() 테스트 전에 한번만 딱 수행 단 한번만 수행된다.
```
const Lottery = artifacts.require('Lottery');

  

contract('Lottery',function([deployer,user1,user2]){ // 여기서 노드 어카운트를 순서대로 받아오는것 

    let lottery;

  

    beforeEach( async() => {

        console.log('Befor Each');

        lottery = await Lottery.new();//이게 컨트랙트 배포 

    })

  

    it('Basic test', async() => {

  

        console.log("basic testtset");

        let owner = await lottery.owner();

        let value = await lottery.getSomeValue();

  

        console.log(`owenr ${owner}`);

        console.log(`value: ${value}`);

        assert.equal(value,5);

    })

});
```